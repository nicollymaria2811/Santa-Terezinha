<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mecânico - Santa Terezinha</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/modern.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-bus"></i>
                    <h1>Sistema Santa Terezinha</h1>
                </div>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar" onclick="abrirModalPerfil()" style="cursor: pointer; transition: all 0.3s;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">PO</div>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Sair
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container main-content">
        <h2>Painel do Mecânico</h2>
        <p class="stat-desc">Gerencie chamados de manutenção e resolva problemas</p>
        
        <!-- Dashboard Stats -->
        <div class="dashboard">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Chamados Abertos</h3>
                    <div class="card-icon">
                        <i class="fas fa-tools"></i>
                    </div>
                </div>
                <div class="stat-number" id="chamadosAbertos">3</div>
                <p class="stat-desc">Aguardando atendimento</p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Em Andamento</h3>
                    <div class="card-icon">
                        <i class="fas fa-wrench"></i>
                    </div>
                </div>
                <div class="stat-number" id="chamadosAndamento">1</div>
                <p class="stat-desc">Sendo resolvidos</p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Resolvidos Hoje</h3>
                    <div class="card-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                </div>
                <div class="stat-number" id="chamadosResolvidos">2</div>
                <p class="stat-desc">Concluídos com sucesso</p>
            </div>
        </div>
        
        <!-- Tabs Section -->
        <div class="tabs">
            <div class="tab-header">
                <button class="tab-button active" onclick="openTab('chamados')">
                    <i class="fas fa-tools"></i> Chamados
                </button>
            </div>
        </div>
        
        <!-- Tab Contents -->
        <div id="chamados" class="tab-content active">
            <h3>Painel de Chamados</h3>
            <p>Gerencie os chamados técnicos</p>
            
            <div id="chamadosList">
                <!-- Chamados serão carregados aqui -->
            </div>
        </div>
    </main>

    <!-- Modal de Perfil -->
    <div id="modalPerfil" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); backdrop-filter: blur(5px);">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border-radius: 20px; padding: 2rem; max-width: 500px; width: 90%; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 style="font-size: 1.5rem; font-weight: 700; color: #1f2937; margin: 0;">Perfil do Mecânico</h2>
                <button onclick="fecharModalPerfil()" style="background: none; border: none; font-size: 1.5rem; color: #6b7280; cursor: pointer; padding: 0.5rem; border-radius: 50%; transition: all 0.3s;" onmouseover="this.style.background='#f3f4f6'" onmouseout="this.style.background='none'">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div style="text-align: center; margin-bottom: 2rem;">
                <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; font-size: 2rem; color: white; font-weight: 700;" id="modalAvatar">
                    PO
                </div>
                <h3 style="font-size: 1.25rem; font-weight: 600; color: #1f2937; margin: 0;" id="modalNome">Pedro Oliveira</h3>
                <p style="color: #6b7280; margin: 0.5rem 0 0 0;" id="modalCargo">Mecânico</p>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                <div style="padding: 1rem; background: #f8fafc; border-radius: 12px;">
                    <p style="font-size: 0.875rem; color: #6b7280; margin: 0 0 0.5rem 0; font-weight: 500;">CPF</p>
                    <p style="font-size: 1rem; color: #1f2937; margin: 0; font-weight: 600;" id="modalCpf">123.456.789-00</p>
                </div>
                
                <div style="padding: 1rem; background: #f8fafc; border-radius: 12px;">
                    <p style="font-size: 0.875rem; color: #6b7280; margin: 0 0 0.5rem 0; font-weight: 500;">TELEFONE</p>
                    <p style="font-size: 1rem; color: #1f2937; margin: 0; font-weight: 600;">(49) 99999-8888</p>
                </div>
            </div>
            
            <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid #e5e7eb; text-align: center;">
                <button onclick="fecharModalPerfil()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 0.75rem 2rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    <i class="fas fa-check" style="margin-right: 8px;"></i>Fechar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal para Resolver Chamado -->
    <div id="modalResolver" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Resolver Chamado</h3>
                <span class="close" onclick="fecharModalResolver()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="formResolver">
                    <div class="form-group">
                        <label for="solucaoDescricao">Descrição da Solução *</label>
                        <textarea id="solucaoDescricao" class="form-control" rows="4" placeholder="Descreva o que foi feito para resolver o problema..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="solucaoPecas">Peças Utilizadas</label>
                        <textarea id="solucaoPecas" class="form-control" rows="3" placeholder="Liste as peças que foram trocadas ou utilizadas..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="solucaoCusto">Custo Estimado</label>
                        <input type="number" id="solucaoCusto" class="form-control" step="0.01" placeholder="0.00">
                    </div>
                    
                    <div class="form-group">
                        <label for="solucaoObservacoes">Observações Adicionais</label>
                        <textarea id="solucaoObservacoes" class="form-control" rows="3" placeholder="Outras observações importantes..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer" style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="fecharModalResolver()">Cancelar</button>
                <button class="btn btn-primary" onclick="confirmarResolucao()">
                    <i class="fas fa-check"></i> Confirmar Resolução
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer style="background: #8B2323; color: white; padding: 2rem 0 1rem; margin-top: 3rem;">
        <div class="container">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; margin-bottom: 1.5rem;">
                <div>
                    <h3 style="font-size: 1.1rem; font-weight: 700; margin-bottom: 0.8rem; color: white;">Sistema Santa Terezinha</h3>
                    <ul style="list-style: none; padding: 0; margin: 0;">
                        <li style="margin-bottom: 0.4rem; font-size: 0.9rem;">Sistema de gestão de transporte público</li>
                        <li style="margin-bottom: 0.4rem; font-size: 0.9rem;">Fraiburgo/SC</li>
                        <li style="margin-bottom: 0.4rem; font-size: 0.9rem;">Transporte urbano</li>
                    </ul>
                </div>
                <div>
                    <h3 style="font-size: 1.1rem; font-weight: 700; margin-bottom: 0.8rem; color: white;">Contato</h3>
                    <ul style="list-style: none; padding: 0; margin: 0;">
                        <li style="margin-bottom: 0.4rem; font-size: 0.9rem;">contato@santaterezinha.com</li>
                        <li style="margin-bottom: 0.4rem; font-size: 0.9rem;">(49) 99999-9999</li>
                        <li style="margin-bottom: 0.4rem; font-size: 0.9rem;">WhatsApp: (49) 99999-8888</li>
                    </ul>
                </div>
                <div>
                    <h3 style="font-size: 1.1rem; font-weight: 700; margin-bottom: 0.8rem; color: white;">Funcionalidades</h3>
                    <ul style="list-style: none; padding: 0; margin: 0;">
                        <li style="margin-bottom: 0.4rem; font-size: 0.9rem;">
                            <a href="#" onclick="openTab('chamados')" style="color: white; text-decoration: none; transition: color 0.3s;" onmouseover="this.style.color='#ffd700'" onmouseout="this.style.color='white'">
                                Gestão de Chamados
                            </a>
                        </li>
                        <li style="margin-bottom: 0.4rem; font-size: 0.9rem;">
                            <a href="#" onclick="openTab('manutencao')" style="color: white; text-decoration: none; transition: color 0.3s;" onmouseover="this.style.color='#ffd700'" onmouseout="this.style.color='white'">
                                Manutenção Preventiva
                            </a>
                        </li>
                        <li style="margin-bottom: 0.4rem; font-size: 0.9rem;">
                            <a href="#" onclick="openTab('frota')" style="color: white; text-decoration: none; transition: color 0.3s;" onmouseover="this.style.color='#ffd700'" onmouseout="this.style.color='white'">
                                Status da Frota
                            </a>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 style="font-size: 1.1rem; font-weight: 700; margin-bottom: 0.8rem; color: white;">Redes Sociais</h3>
                    <ul style="list-style: none; padding: 0; margin: 0;">
                        <li style="margin-bottom: 0.4rem; font-size: 0.9rem;">
                            <a href="#" style="color: white; text-decoration: none; transition: color 0.3s;" onmouseover="this.style.color='#ffd700'" onmouseout="this.style.color='white'">
                                Facebook
                            </a>
                        </li>
                        <li style="margin-bottom: 0.4rem; font-size: 0.9rem;">
                            <a href="#" style="color: white; text-decoration: none; transition: color 0.3s;" onmouseover="this.style.color='#ffd700'" onmouseout="this.style.color='white'">
                                Instagram
                            </a>
                        </li>
                        <li style="margin-bottom: 0.4rem; font-size: 0.9rem;">
                            <a href="#" style="color: white; text-decoration: none; transition: color 0.3s;" onmouseover="this.style.color='#ffd700'" onmouseout="this.style.color='white'">
                                Twitter
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div style="border-top: 1px solid rgba(255, 255, 255, 0.3); padding-top: 1rem; text-align: center;">
                <p style="color: white; font-size: 0.9rem; margin: 0; font-weight: 500;">
                    Sistema Santa Terezinha - Fraiburgo/SC<br>
                    Rua das Flores, 123 - Centro - CEP: 89580-000<br>
                    Telefone: (49) 99999-9999 | Email: contato@santaterezinha.com
                </p>
                <p style="color: rgba(255, 255, 255, 0.8); font-size: 0.8rem; margin: 0.5rem 0 0 0;">
                    &copy; 2024 Sistema Santa Terezinha. Desenvolvido para melhorar sua experiência no transporte público.
                </p>
            </div>
        </div>
    </footer>

    <script src="js/data.js"></script>
    <script>
        // Estado da aplicação
        let usuarioAtual = null;
        let chamadoAtual = null;

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar se usuário está logado
            const usuario = localStorage.getItem('usuarioAtual');
            if (!usuario) {
                window.location.href = 'login.html';
                return;
            }

            usuarioAtual = JSON.parse(usuario);
            document.getElementById('userAvatar').textContent = usuarioAtual.nome.charAt(0);
            
            // Carregar dados iniciais
            loadDashboard();
            loadChamados();
        });

        // Função para abrir tabs
        function openTab(tabName) {
            // Remover active de todas as tabs
            document.querySelectorAll('.tab-button').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remover active de todos os conteúdos
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Ativar tab clicada
            event.target.classList.add('active');
            
            // Mostrar conteúdo correspondente
            document.getElementById(tabName).classList.add('active');
            
            // Carregar dados específicos
            switch(tabName) {
                case 'chamados':
                    loadChamados();
                    break;
            }
        }

        // Carregar dashboard
        function loadDashboard() {
            const chamados = dadosSistema.buscarChamados();
            const abertos = chamados.filter(c => c.status === 'aberto').length;
            const emAndamento = chamados.filter(c => c.status === 'em_andamento').length;
            const resolvidos = chamados.filter(c => c.status === 'resolvido').length;
            
            document.getElementById('chamadosAbertos').textContent = abertos;
            document.getElementById('chamadosAndamento').textContent = emAndamento;
            document.getElementById('chamadosResolvidos').textContent = resolvidos;
            
            // Atualizar descrições baseadas nos dados reais
            document.querySelector('#chamadosAbertos').parentElement.querySelector('.stat-desc').textContent = 
                abertos === 0 ? 'Nenhum chamado aguardando' : `${abertos} aguardando atendimento`;
            
            document.querySelector('#chamadosAndamento').parentElement.querySelector('.stat-desc').textContent = 
                emAndamento === 0 ? 'Nenhum em andamento' : `${emAndamento} sendo resolvidos`;
            
            document.querySelector('#chamadosResolvidos').parentElement.querySelector('.stat-desc').textContent = 
                resolvidos === 0 ? 'Nenhum resolvido hoje' : `${resolvidos} concluídos com sucesso`;
        }

        // Carregar chamados
        function loadChamados() {
            const container = document.getElementById('chamadosList');
            const chamados = dadosSistema.buscarChamados();
            
            container.innerHTML = '';
            
            if (chamados.length === 0) {
                container.innerHTML = '<p class="stat-desc">Nenhum chamado encontrado.</p>';
                return;
            }
            
            chamados.forEach(chamado => {
                const chamadoCard = document.createElement('div');
                chamadoCard.className = 'card';
                chamadoCard.style.marginBottom = '20px';
                
                let solucaoHtml = '';
                if (chamado.solucao) {
                    solucaoHtml = `
                        <div class="solucao">
                            <h4><i class="fas fa-check-circle"></i> Solução Aplicada</h4>
                            <p><strong>Descrição:</strong> ${chamado.solucao.descricao}</p>
                            ${chamado.solucao.pecas ? `<p><strong>Peças:</strong> ${chamado.solucao.pecas}</p>` : ''}
                            ${chamado.solucao.custo ? `<p><strong>Custo:</strong> R$ ${chamado.solucao.custo}</p>` : ''}
                            ${chamado.solucao.observacoes ? `<p><strong>Observações:</strong> ${chamado.solucao.observacoes}</p>` : ''}
                            <p style="font-size: 0.8rem; color: var(--gray); margin-top: 10px;">
                                <i class="fas fa-clock"></i> ${formatarData(chamado.solucao.data)}
                            </p>
                        </div>
                    `;
                }
                
                chamadoCard.innerHTML = `
                    <div class="card-header">
                        <h3 class="card-title">Chamado #${chamado.id}</h3>
                        <span class="status-badge ${chamado.status === 'aberto' ? 'danger' : chamado.status === 'em_andamento' ? 'warning' : 'success'}">${chamado.status.toUpperCase()}</span>
                    </div>
                    <div class="card-body">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0;">
                            <div style="padding: 15px; background: #f8fafc; border-radius: 10px; border-left: 4px solid #3b82f6;">
                                <p style="font-size: 0.875rem; color: #6b7280; margin-bottom: 5px; font-weight: 500;">MOTORISTA</p>
                                <p style="font-weight: 600; color: #1f2937; font-size: 1.1rem;">${chamado.motorista}</p>
                            </div>
                            <div style="padding: 15px; background: #f8fafc; border-radius: 10px; border-left: 4px solid #10b981;">
                                <p style="font-size: 0.875rem; color: #6b7280; margin-bottom: 5px; font-weight: 500;">VEÍCULO</p>
                                <p style="font-weight: 600; color: #1f2937; font-size: 1.1rem;">${chamado.veiculo}</p>
                            </div>
                            <div style="padding: 15px; background: #f8fafc; border-radius: 10px; border-left: 4px solid #f59e0b;">
                                <p style="font-size: 0.875rem; color: #6b7280; margin-bottom: 5px; font-weight: 500;">TIPO</p>
                                <p style="font-weight: 600; color: #1f2937; font-size: 1.1rem;">${chamado.tipo}</p>
                            </div>
                            <div style="padding: 15px; background: #f8fafc; border-radius: 10px; border-left: 4px solid #8b5cf6;">
                                <p style="font-size: 0.875rem; color: #6b7280; margin-bottom: 5px; font-weight: 500;">URGÊNCIA</p>
                                <span class="status-badge ${chamado.urgencia === 'alta' ? 'danger' : chamado.urgencia === 'media' ? 'warning' : 'success'}">${chamado.urgencia.toUpperCase()}</span>
                            </div>
                        </div>
                        
                        <div style="margin: 20px 0; padding: 20px; background: #f1f5f9; border-radius: 12px;">
                            <p style="font-size: 1rem; color: #374151; margin-bottom: 10px; font-weight: 600;">
                                <i class="fas fa-clipboard-list" style="margin-right: 8px; color: #3b82f6;"></i>Descrição do Problema
                            </p>
                            <p style="color: #6b7280; line-height: 1.6; font-size: 1rem;">${chamado.descricao}</p>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 20px 0; padding: 15px; background: #f8fafc; border-radius: 10px;">
                            <div style="display: flex; flex-direction: column; gap: 5px;">
                                <span style="font-size: 0.875rem; color: #6b7280;">
                                    <i class="fas fa-clock"></i> ${formatarData(chamado.data)}
                                </span>
                                ${chamado.mecanico ? `<span style="font-size: 0.875rem; color: #6b7280;"><i class="fas fa-user-cog"></i> Mecânico: ${chamado.mecanico}</span>` : ''}
                            </div>
                            <div style="display: flex; gap: 10px;">
                                ${chamado.status === 'aberto' ? 
                                    `<button class="btn btn-warning btn-sm" onclick="assumirChamado(${chamado.id})">
                                        <i class="fas fa-tools"></i> Assumir Chamado
                                    </button>` : ''
                                }
                                ${chamado.status === 'em_andamento' ? 
                                    `<button class="btn btn-primary btn-sm" onclick="abrirModalResolver(${chamado.id})">
                                        <i class="fas fa-check"></i> Resolver Chamado
                                    </button>` : ''
                                }
                            </div>
                        </div>
                        
                        ${solucaoHtml}
                        
                        ${chamado.status === 'em_andamento' ? `
                            <div style="margin-top: 20px; padding: 20px; background: #fef3c7; border-radius: 12px; border: 1px solid #f59e0b;">
                                <h4 style="margin-bottom: 15px; color: #92400e; display: flex; align-items: center;">
                                    <i class="fas fa-wrench" style="margin-right: 8px;"></i>
                                    Resolução do Chamado
                                </h4>
                                <form id="formResolverInline${chamado.id}" onsubmit="resolverChamadoInline(${chamado.id}, event)">
                                    <div class="form-group">
                                        <label for="solucaoDescricao${chamado.id}">Descrição da Solução *</label>
                                        <textarea id="solucaoDescricao${chamado.id}" class="form-control" rows="3" placeholder="Descreva o que foi feito para resolver o problema..." required></textarea>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="solucaoPecas${chamado.id}">Peças Utilizadas</label>
                                        <textarea id="solucaoPecas${chamado.id}" class="form-control" rows="2" placeholder="Liste as peças que foram trocadas ou utilizadas..."></textarea>
                                    </div>
                                    
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                        <div class="form-group">
                                            <label for="solucaoCusto${chamado.id}">Custo Estimado (R$)</label>
                                            <input type="number" id="solucaoCusto${chamado.id}" class="form-control" step="0.01" placeholder="0.00">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="urgenciaConfirmada${chamado.id}">Confirmar Urgência</label>
                                            <select id="urgenciaConfirmada${chamado.id}" class="form-control">
                                                <option value="${chamado.urgencia}">${chamado.urgencia.toUpperCase()}</option>
                                                <option value="baixa">BAIXA</option>
                                                <option value="media">MÉDIA</option>
                                                <option value="alta">ALTA</option>
                                                <option value="critica">CRÍTICA</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="solucaoObservacoes${chamado.id}">Observações Adicionais</label>
                                        <textarea id="solucaoObservacoes${chamado.id}" class="form-control" rows="2" placeholder="Outras observações importantes..."></textarea>
                                    </div>
                                    
                                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                                        <button type="submit" class="btn btn-success">
                                            <i class="fas fa-check"></i> Confirmar Resolução
                                        </button>
                                        <button type="button" class="btn btn-secondary" onclick="cancelarResolucaoInline(${chamado.id})">
                                            <i class="fas fa-times"></i> Cancelar
                                        </button>
                                    </div>
                                </form>
                            </div>
                        ` : ''}
                    </div>
                `;
                container.appendChild(chamadoCard);
            });
        }

        // Assumir chamado
        function assumirChamado(id) {
            dadosSistema.atualizarStatusChamado(id, 'em_andamento', usuarioAtual.nome);
            loadChamados();
            loadDashboard();
            showNotification('Chamado assumido com sucesso!', 'success');
        }

        // Resolver chamado inline
        function resolverChamadoInline(id, event) {
            event.preventDefault();
            
            const descricao = document.getElementById(`solucaoDescricao${id}`).value;
            const pecas = document.getElementById(`solucaoPecas${id}`).value;
            const custo = document.getElementById(`solucaoCusto${id}`).value;
            const observacoes = document.getElementById(`solucaoObservacoes${id}`).value;
            const urgenciaConfirmada = document.getElementById(`urgenciaConfirmada${id}`).value;
            
            if (!descricao) {
                showNotification('A descrição da solução é obrigatória.', 'error');
                return;
            }
            
            // Atualizar chamado
            const chamado = dadosSistema.chamados.find(c => c.id === id);
            if (chamado) {
                chamado.status = 'resolvido';
                chamado.mecanico = usuarioAtual.nome;
                chamado.urgencia = urgenciaConfirmada; // Atualizar urgência confirmada
                chamado.solucao = {
                    descricao: descricao,
                    pecas: pecas,
                    custo: custo,
                    observacoes: observacoes,
                    data: new Date().toISOString().slice(0, 16).replace('T', ' ')
                };
            }
            
            loadChamados();
            loadDashboard();
            showNotification('Chamado resolvido com sucesso!', 'success');
        }

        // Cancelar resolução inline
        function cancelarResolucaoInline(id) {
            const form = document.getElementById(`formResolverInline${id}`);
            form.reset();
        }

        // Abrir modal de resolução
        function abrirModalResolver(id) {
            chamadoAtual = id;
            document.getElementById('modalResolver').style.display = 'block';
        }

        // Fechar modal de resolução
        function fecharModalResolver() {
            chamadoAtual = null;
            document.getElementById('modalResolver').style.display = 'none';
            document.getElementById('formResolver').reset();
        }

        // Confirmar resolução
        function confirmarResolucao() {
            const descricao = document.getElementById('solucaoDescricao').value;
            const pecas = document.getElementById('solucaoPecas').value;
            const custo = document.getElementById('solucaoCusto').value;
            const observacoes = document.getElementById('solucaoObservacoes').value;
            
            if (!descricao) {
                showNotification('A descrição da solução é obrigatória.', 'error');
                return;
            }
            
            // Atualizar chamado
            const chamado = dadosSistema.chamados.find(c => c.id === chamadoAtual);
            if (chamado) {
                chamado.status = 'resolvido';
                chamado.mecanico = usuarioAtual.nome;
                chamado.solucao = {
                    descricao: descricao,
                    pecas: pecas,
                    custo: custo,
                    observacoes: observacoes,
                    data: new Date().toISOString().slice(0, 16).replace('T', ' ')
                };
            }
            
            loadChamados();
            loadDashboard();
            fecharModalResolver();
            showNotification('Chamado resolvido com sucesso!', 'success');
        }

        // Fechar modal ao clicar fora
        document.getElementById('modalResolver').addEventListener('click', function(e) {
            if (e.target === this) {
                fecharModalResolver();
            }
        });

        // Funções utilitárias
        function formatarData(dataString) {
            const data = new Date(dataString);
            return data.toLocaleString('pt-BR');
        }

        function logout() {
            localStorage.removeItem('usuarioAtual');
            window.location.href = 'login.html';
        }

        // Modal de Perfil
        function abrirModalPerfil() {
            document.getElementById('modalPerfil').style.display = 'block';
        }

        function fecharModalPerfil() {
            document.getElementById('modalPerfil').style.display = 'none';
        }

        // Fechar modal ao clicar fora
        document.getElementById('modalPerfil').addEventListener('click', function(e) {
            if (e.target === this) {
                fecharModalPerfil();
            }
        });

        function showNotification(message, type = 'info') {
            // Criar elemento de notificação
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 1000;
                padding: 15px 20px;
                border-radius: 6px;
                color: white;
                font-weight: 500;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                background: ${type === 'success' ? 'var(--success)' : type === 'error' ? 'var(--danger)' : 'var(--primary)'};
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Remover após 3 segundos
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
</body>
</html>